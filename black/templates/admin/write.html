{% extends "admin/base.html" %}
{% block main %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
<script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>

<h2 style="margin-bottom: 30px; color: #636e72;">{{ 'ä¿®æ”¹ç¯‡ç« ' if post else 'å¼€å¯æ–°ç¯‡ç« ' }}</h2>

<form action="{{ url_for('save_post') }}" method="POST" enctype="multipart/form-data">
    {% if post %}<input type="hidden" name="post_id" value="{{ post.id }}">{% endif %}
    
    <div style="margin-bottom: 25px;">
        <input type="text" name="title" value="{{ post.title if post else '' }}" 
               placeholder="ç»™æ•…äº‹èµ·ä¸ªæ ‡é¢˜å§..." 
               style="width: 100%; padding: 15px; border: 2px solid #eee; border-radius: 12px; font-size: 18px; outline: none; transition: 0.3s;"
               onfocus="this.style.borderColor='var(--primary)'" onblur="this.style.borderColor='#eee'" required>
    </div>

    <div style="margin-bottom: 25px; background: rgba(162, 155, 254, 0.05); padding: 20px; border-radius: 12px; border: 1px dashed var(--primary);">
        <label style="display: block; margin-bottom: 10px; font-weight: bold; color: var(--primary);">ğŸ–¼ï¸ å°é¢å›¾è®¾ç½®</label>
        <input type="file" name="cover" style="font-size: 14px; color: #636e72;">
    </div>

    <div style="margin-bottom: 25px;">
        <textarea name="content" id="mde">{{ post.content if post else '' }}</textarea>
    </div>

    <button type="submit" class="btn-anime" style="width: 100%; padding: 18px; font-size: 18px;">ä¿å­˜å¹¶è®°å½• (âœ§â—¡âœ§)</button>
</form>

<script>
    var simplemde = new SimpleMDE({ 
        element: document.getElementById("mde"),
        spellChecker: false,
        autosave: { enabled: true, uniqueId: "mage_blog_edit" },
        toolbar: ["bold", "italic", "heading", "|", "quote", "unordered-list", "ordered-list", "|", "link", "image", "|", "side-by-side", "fullscreen"]
    });
</script>

<style>
    /* æ·±åº¦å®šåˆ¶ç¼–è¾‘å™¨æ ·å¼ */
    .CodeMirror { border-radius: 0 0 12px 12px; border: 2px solid #eee; font-size: 16px; }
    .editor-toolbar { border-radius: 12px 12px 0 0; border: 2px solid #eee; background: white; }
    .editor-preview-side { background: #fffcfd; }
</style>
{% endblock %}